# AMSI bypass via unicorn

## AMSI - unicorn

![](../../../.gitbook/assets/d5b738d7e23f4165bde99c7777e814fb.png)

hook process memory space

-&gt; AMSI scan \(2 API SmsiScanString\)

![](../../../.gitbook/assets/5fadb4feb34841e5ac10704843d81e1d.png)

create a payload , decode

break the code on windows using powershell ise

* add variables:

![](../../../.gitbook/assets/68abde315d8b41a8a5df914b7af61e26.png)

test or int int

![](../../../.gitbook/assets/085241dcdc3c4a219085f5da5c2d840a.png)

### scanning memory space :

![](../../../.gitbook/assets/ef69a95fe2644cbdaf928a1a5e64bc83.png)

it search

psamsi true or flase

![](../../../.gitbook/assets/7c99dc64a8684a9fac22f5e1e8a4ec38.png)

POC exploitdb

![](../../../.gitbook/assets/5af34d7f18e444609bfc159c2b667dc5.png)

{% embed url="https://hacker.house/lab/windows-defender-bypassing-for-meterpreter/" %}

{% embed url="https://slaeryan.github.io/posts/falcon-zero-alpha.html" %}

Rasta mouse :

disable amsi in the process space

{% embed url="https://raw.githubusercontent.com/rasta-mouse/AmsiScanBufferBypass/master/ASBBypass.ps1" %}



Win32 to 1111

![](../../../.gitbook/assets/9400517eb52a477d950d9515da5e5db5.png)

![](../../../.gitbook/assets/9a79277dfbfc4785a7a17809aa313659.png)

![](../../../.gitbook/assets/52d2668f78a54823acf776e9a5b0b7a4.png)

![](../../../.gitbook/assets/75fefa533c97436ba959e21b5e40d76e.png)

-&gt; detected

tweak

### Resources

{% embed url="https://www.trustedsec.com/" %}





