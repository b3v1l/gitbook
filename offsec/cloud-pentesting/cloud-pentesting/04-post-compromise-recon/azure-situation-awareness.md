# Azure Situation Awareness

## Azure Situation Awareness

* Try to find other accounts name via azure portal
* Try CLI is portal is unreachable
* Powerzure and Microbust

Note: Directory can have multiple Tenant accesses.

* Enumerate subscription
* Roles \(owner, reader ...\)
* Gather usernames for futher attacks
* Resources
* Runbooks
* VM templates
* SQL connection
* Virtual Network

### Azure Hierarchy

![](../../../../.gitbook/assets/5655be77a9db43cca084ba2325a22035.png)

![](../../../../.gitbook/assets/b9cbf0ab1e20491ca70cd7ad2ee7410f.png)

### Powerzure

```csharp
git clone https://github.com/hausec/PowerZure
```

![](../../../../.gitbook/assets/1bf706aa6689404aafde74cc4d6f6910.png)

* List current user info, Enum Roles and Subscriptions

```csharp
Get-CurrentUser
```

![](../../../../.gitbook/assets/7da61201a35f486c9c0e939ff016faae.png)

* Enum users/groups

```csharp
get-allusers
get-allgroups
get-groupmembers
```

![](../../../../.gitbook/assets/b583fd67118d4408a6c4d219c0fea76f.png)

* Get Resources list

```csharp
get-resources
```

* List applications 

```csharp
get-apps
```

* List members of a role

```csharp
get-rolemembers ROLE
```

![](../../../../.gitbook/assets/17f4b316fd644a10b0334cc2af78b523.png)

* List webapps

```csharp
get-webapps
```

* List key vaults

```csharp
get-keyvaults
```

* List storage accounts

```csharp
Get-StorageAccounts
```

* List Runbooks

```csharp
get-runbooks
```

* List Virtual Machine

```csharp
get-vms
```

### Active Directory

* powerview
* Bloodhound
* HostRecon

### Resources

{% embed url="https://github.com/hausec/PowerZure" %}

{% embed url="https://github.com/BloodHoundAD/BloodHound" %}

{% embed url="https://github.com/dafthack/HostRecon" %}

