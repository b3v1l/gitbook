# Azure SQL

## Azure SQL

#### Azure SQL server get a DNS name at &lt;SERVERNAME&gt;.database.windows.net

SQL Server can be administrated through the Azure portal

Port 1443 can be reachable.

* Azure SQL databe require a SQL Cloud server \(2 separated resources\)
* Azure Transparent Data Encryption \(TDE\) is enbale by default
* Data are encrypted by default \(except if you export them\)
* Server admin cannot be named "admin/administrator", "sa", "root", "dbmanager", "guest"

### List Azure SQL servers

```csharp
get-AzSQLServer
```

![](../../../../../.gitbook/assets/image%20%28270%29.png)

### List Database

```csharp
get-AzSqlDAtabse -Servername <SERVER> -ResourceGroupName  <ResourceGroupName>
```

### List SQL Admins Groups

Groups can be applied as SQL server Active Directory Admins.

Maybe we are already in the specific group or can be added to access the DBs

```csharp
get-AzSqlServerActiveDirectoryAdministrator -servername <SERVER> -ResourceGroupName  <ResourceGroupName>
```

### Change firewall rule

Require specific access

```csharp
get-AzSqlServerFirewallRule  -Servername <SERVER> -ResourceGroupName  <ResourceGroupName>
```

### Exporting Data \(unencrypted BACPAC files\)

Azure SQL BACPAC backup files are not encrypted \(even if Transparent Data encryption is enabled\).

Search for bacpac on disk or blob storage and then restore in another Azure account to retrieve data.

```csharp
get-AzSqlDatabaseTransparentDataEncryption  -Servername <SERVER> -ResourceGroupName  <ResourceGroupName>
```

### SQL port scan \| DNS subdomains bruteforcing

Bruteforce subdomain SQL server and portscan

* Usual nmap scan. Port 1443 is open, login bruteforce can be tested

![](../../../../../.gitbook/assets/image%20%2860%29.png)



