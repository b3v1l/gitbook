# PTA Agent Injection

## PTA Agent Injection

DLL injection into Pass Through Authentication agent to intercept clear-text auth.

* When a user authenticateds to Azure/O365, the creds are verified on on-Prem Domain Controller using the PTA agent.
* AzureADConnectAythenticationAgentService.exe is the service where the creds are validated and relies on the Win32 API **LogonUserW :**  abusing an Admin access, a DLL can be injection into the Azure AD Sync Process where LoginUserW function can nbe patched. From there, everytime a user authenticate, his credentials can be retrieved.

### Resources

{% embed url="https://blog.xpnsec.com/azuread-connect-for-redteam/" %}

