# Recon as an authenticated user

## User situation via portal.azure.com

> After login, search for the user in the Active Directory panel and retrieve "Assigned roles"

![](<../../../../.gitbook/assets/image (4).png>)

> Next, enumerate users, groups, devices, directory roles and enterprise applications

## Azure AD module&#x20;

> AzureAD module must be used to manage Azure AD. It doesn't work with Azure resources

* Install the module

`install-module AzureAD`

* connect

```python
#$creds = Get-Credentials

or

$passwd = ConvertTo-SecureString "superPassword" -AsPlainText -Force
$creds = New-Object System.Management.Automation.PSCredential("test@defcorphq.onmicrosoft.com", $passwd)
Connect-AzureAD -Credential $creds
```

### Enumeration

* get tenant details

```powershell
 Get-AzureADTenantDetail
```

* Retrieve current session state

```powershell
Get-AzureADCurrentSessionInfo
```

* enumerate all users

`Get-AzureADUser -All $true`

* enumerate one specific user

`Get-AzureADUser -ObjectId test@company.onmicrosoft.com`

* search for a service principal name or username which starts with XXXX

`Get-AzureADUser -SearchString "admin"`

* Search for a users who contains "admin" in their display name

`Get-AzureADUser -All $true |?{$_.Displayname -match "admin"}`

