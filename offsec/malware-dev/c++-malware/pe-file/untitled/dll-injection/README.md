# Dll injection

## Dll injection

### AllocateMemory

Inject a DLL file from the disk into a targeted process. For instance, the Dropper can inject the DLL by:

* **Downloading it from the C2C**
* **Upload a DLL located on the files system**

Dropper \(contains path to DLL, which is stored on the disk\) allocate memory on the target process\).

The dropper goal is to provide the DLL path to the target process

#### Note: Check Reflected DLL injection

### CopyPath

DLL Path is copied from the dropper to the buffer located on target system

### LoadLibray

We need to locate the address of the LoadLibrary.

2 ways:

1. Open up the target process, parse it and locate the module kernel32.dll \(which implement the LoadLibray function\)the address remotely
2. If the kernel32.dll is located on the same address \(dropper and target\), We can use `GetProcAddress` function inside the dropper to retrieve the LoadLibrary address and use it on the target process.

### Summary

1. Get LoadLibrary address from the dropper using `GetProcAddress`
2. Allocate mememory on the target using `VirtualAllocEx`
3. Copy the DLL path using `WriteProcessMemory`
4. Execute the whole thing using `CreateRemoteThread` \(using the LoadLibrary Address and the DLL Path\)

